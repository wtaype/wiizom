import{j as rr}from"./vendor-gzd0YkcT.js";import{g as tr,b as ee,s as Oe,M as ae}from"./main-Cjh740bR.js";import"./main-B3WV2BBk.js";function or(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var ie={exports:{}},Ce;function nr(){return Ce||(Ce=1,(function(o){var t=(function(a){var l=Object.prototype,i=l.hasOwnProperty,d=Object.defineProperty||function(r,e,n){r[e]=n.value},h,w=typeof Symbol=="function"?Symbol:{},I=w.iterator||"@@iterator",W=w.asyncIterator||"@@asyncIterator",G=w.toStringTag||"@@toStringTag";function R(r,e,n){return Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),r[e]}try{R({},"")}catch{R=function(e,n,c){return e[n]=c}}function D(r,e,n,c){var s=e&&e.prototype instanceof y?e:y,p=Object.create(s.prototype),_=new Z(c||[]);return d(p,"_invoke",{value:oe(r,n,_)}),p}a.wrap=D;function z(r,e,n){try{return{type:"normal",arg:r.call(e,n)}}catch(c){return{type:"throw",arg:c}}}var H="suspendedStart",m="suspendedYield",L="executing",B="completed",b={};function y(){}function O(){}function k(){}var F={};R(F,I,function(){return this});var Y=Object.getPrototypeOf,$=Y&&Y(Y(V([])));$&&$!==l&&i.call($,I)&&(F=$);var N=k.prototype=y.prototype=Object.create(F);O.prototype=k,d(N,"constructor",{value:k,configurable:!0}),d(k,"constructor",{value:O,configurable:!0}),O.displayName=R(k,G,"GeneratorFunction");function K(r){["next","throw","return"].forEach(function(e){R(r,e,function(n){return this._invoke(e,n)})})}a.isGeneratorFunction=function(r){var e=typeof r=="function"&&r.constructor;return e?e===O||(e.displayName||e.name)==="GeneratorFunction":!1},a.mark=function(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,k):(r.__proto__=k,R(r,G,"GeneratorFunction")),r.prototype=Object.create(N),r},a.awrap=function(r){return{__await:r}};function x(r,e){function n(p,_,E,T){var S=z(r[p],r,_);if(S.type==="throw")T(S.arg);else{var u=S.arg,f=u.value;return f&&typeof f=="object"&&i.call(f,"__await")?e.resolve(f.__await).then(function(v){n("next",v,E,T)},function(v){n("throw",v,E,T)}):e.resolve(f).then(function(v){u.value=v,E(u)},function(v){return n("throw",v,E,T)})}}var c;function s(p,_){function E(){return new e(function(T,S){n(p,_,T,S)})}return c=c?c.then(E,E):E()}d(this,"_invoke",{value:s})}K(x.prototype),R(x.prototype,W,function(){return this}),a.AsyncIterator=x,a.async=function(r,e,n,c,s){s===void 0&&(s=Promise);var p=new x(D(r,e,n,c),s);return a.isGeneratorFunction(e)?p:p.next().then(function(_){return _.done?_.value:p.next()})};function oe(r,e,n){var c=H;return function(p,_){if(c===L)throw new Error("Generator is already running");if(c===B){if(p==="throw")throw _;return re()}for(n.method=p,n.arg=_;;){var E=n.delegate;if(E){var T=M(E,n);if(T){if(T===b)continue;return T}}if(n.method==="next")n.sent=n._sent=n.arg;else if(n.method==="throw"){if(c===H)throw c=B,n.arg;n.dispatchException(n.arg)}else n.method==="return"&&n.abrupt("return",n.arg);c=L;var S=z(r,e,n);if(S.type==="normal"){if(c=n.done?B:m,S.arg===b)continue;return{value:S.arg,done:n.done}}else S.type==="throw"&&(c=B,n.method="throw",n.arg=S.arg)}}}function M(r,e){var n=e.method,c=r.iterator[n];if(c===h)return e.delegate=null,n==="throw"&&r.iterator.return&&(e.method="return",e.arg=h,M(r,e),e.method==="throw")||n!=="return"&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var s=z(c,r.iterator,e.arg);if(s.type==="throw")return e.method="throw",e.arg=s.arg,e.delegate=null,b;var p=s.arg;if(!p)return e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,b;if(p.done)e[r.resultName]=p.value,e.next=r.nextLoc,e.method!=="return"&&(e.method="next",e.arg=h);else return p;return e.delegate=null,b}K(N),R(N,G,"Generator"),R(N,I,function(){return this}),R(N,"toString",function(){return"[object Generator]"});function A(r){var e={tryLoc:r[0]};1 in r&&(e.catchLoc=r[1]),2 in r&&(e.finallyLoc=r[2],e.afterLoc=r[3]),this.tryEntries.push(e)}function J(r){var e=r.completion||{};e.type="normal",delete e.arg,r.completion=e}function Z(r){this.tryEntries=[{tryLoc:"root"}],r.forEach(A,this),this.reset(!0)}a.keys=function(r){var e=Object(r),n=[];for(var c in e)n.push(c);return n.reverse(),function s(){for(;n.length;){var p=n.pop();if(p in e)return s.value=p,s.done=!1,s}return s.done=!0,s}};function V(r){if(r){var e=r[I];if(e)return e.call(r);if(typeof r.next=="function")return r;if(!isNaN(r.length)){var n=-1,c=function s(){for(;++n<r.length;)if(i.call(r,n))return s.value=r[n],s.done=!1,s;return s.value=h,s.done=!0,s};return c.next=c}}return{next:re}}a.values=V;function re(){return{value:h,done:!0}}return Z.prototype={constructor:Z,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=h,this.done=!1,this.delegate=null,this.method="next",this.arg=h,this.tryEntries.forEach(J),!r)for(var e in this)e.charAt(0)==="t"&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=h)},stop:function(){this.done=!0;var r=this.tryEntries[0],e=r.completion;if(e.type==="throw")throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function n(T,S){return p.type="throw",p.arg=r,e.next=T,S&&(e.method="next",e.arg=h),!!S}for(var c=this.tryEntries.length-1;c>=0;--c){var s=this.tryEntries[c],p=s.completion;if(s.tryLoc==="root")return n("end");if(s.tryLoc<=this.prev){var _=i.call(s,"catchLoc"),E=i.call(s,"finallyLoc");if(_&&E){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(_){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else if(E){if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(r,e){for(var n=this.tryEntries.length-1;n>=0;--n){var c=this.tryEntries[n];if(c.tryLoc<=this.prev&&i.call(c,"finallyLoc")&&this.prev<c.finallyLoc){var s=c;break}}s&&(r==="break"||r==="continue")&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var p=s?s.completion:{};return p.type=r,p.arg=e,s?(this.method="next",this.next=s.finallyLoc,b):this.complete(p)},complete:function(r,e){if(r.type==="throw")throw r.arg;return r.type==="break"||r.type==="continue"?this.next=r.arg:r.type==="return"?(this.rval=this.arg=r.arg,this.method="return",this.next="end"):r.type==="normal"&&e&&(this.next=e),b},finish:function(r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===r)return this.complete(n.completion,n.afterLoc),J(n),b}},catch:function(r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===r){var c=n.completion;if(c.type==="throw"){var s=c.arg;J(n)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:V(r),resultName:e,nextLoc:n},this.method==="next"&&(this.arg=h),b}},a})(o.exports);try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}})(ie)),ie.exports}var se,Pe;function Te(){return Pe||(Pe=1,se=(o,t)=>`${o}-${t}-${Math.random().toString(16).slice(3,8)}`),se}var ce,Ie;function Ve(){if(Ie)return ce;Ie=1;const o=Te();let t=0;return ce=({id:a,action:l,payload:i={}})=>{let d=a;return typeof d>"u"&&(d=o("Job",t),t+=1),{id:d,action:l,payload:i}},ce}var Q={},qe;function ke(){if(qe)return Q;qe=1;let o=!1;return Q.logging=o,Q.setLogging=t=>{o=t},Q.log=(...t)=>o?console.log.apply(this,t):null,Q}var le,Ne;function ar(){if(Ne)return le;Ne=1;const o=Ve(),{log:t}=ke(),a=Te();let l=0;return le=()=>{const i=a("Scheduler",l),d={},h={};let w=[];l+=1;const I=()=>w.length,W=()=>Object.keys(d).length,G=()=>{if(w.length!==0){const m=Object.keys(d);for(let L=0;L<m.length;L+=1)if(typeof h[m[L]]>"u"){w[0](d[m[L]]);break}}},R=(m,L)=>new Promise((B,b)=>{const y=o({action:m,payload:L});w.push(async O=>{w.shift(),h[O.id]=y;try{B(await O[m].apply(this,[...L,y.id]))}catch(k){b(k)}finally{delete h[O.id],G()}}),t(`[${i}]: Add ${y.id} to JobQueue`),t(`[${i}]: JobQueue length=${w.length}`),G()});return{addWorker:m=>(d[m.id]=m,t(`[${i}]: Add ${m.id}`),t(`[${i}]: Number of workers=${W()}`),G(),m.id),addJob:async(m,...L)=>{if(W()===0)throw Error(`[${i}]: You need to have at least one worker before adding jobs`);return R(m,L)},terminate:async()=>{Object.keys(d).forEach(async m=>{await d[m].terminate()}),w=[]},getQueueLen:I,getNumWorkers:W}},le}function ir(o){throw new Error('Could not dynamically require "'+o+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ue,Me;function sr(){return Me||(Me=1,ue=o=>{const t={};return typeof WorkerGlobalScope<"u"?t.type="webworker":typeof document=="object"?t.type="browser":typeof process=="object"&&typeof ir=="function"&&(t.type="node"),typeof o>"u"?t:t[o]}),ue}var de,je;function cr(){if(je)return de;je=1;const t=sr()("type")==="browser"?a=>new URL(a,window.location.href).href:a=>a;return de=a=>{const l={...a};return["corePath","workerPath","langPath"].forEach(i=>{a[i]&&(l[i]=t(l[i]))}),l},de}var fe,Ge;function Qe(){return Ge||(Ge=1,fe={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),fe}const lr="7.0.0",ur={version:lr};var pe,De;function dr(){return De||(De=1,pe={workerBlobURL:!0,logger:()=>{}}),pe}var he,Ue;function fr(){if(Ue)return he;Ue=1;const o=ur.version;return he={...dr(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${o}/dist/worker.min.js`},he}var ve,We;function pr(){return We||(We=1,ve=({workerPath:o,workerBlobURL:t})=>{let a;if(Blob&&URL&&t){const l=new Blob([`importScripts("${o}");`],{type:"application/javascript"});a=new Worker(URL.createObjectURL(l))}else a=new Worker(o);return a}),ve}var ge,ze;function hr(){return ze||(ze=1,ge=o=>{o.terminate()}),ge}var me,Be;function vr(){return Be||(Be=1,me=(o,t)=>{o.onmessage=({data:a})=>{t(a)}}),me}var ye,$e;function gr(){return $e||($e=1,ye=async(o,t)=>{o.postMessage(t)}),ye}var we,Fe;function mr(){if(Fe)return we;Fe=1;const o=a=>new Promise((l,i)=>{const d=new FileReader;d.onload=()=>{l(d.result)},d.onerror=({target:{error:{code:h}}})=>{i(Error(`File could not be read! Code=${h}`))},d.readAsArrayBuffer(a)}),t=async a=>{let l=a;if(typeof a>"u")return"undefined";if(typeof a=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(a)?l=atob(a.split(",")[1]).split("").map(i=>i.charCodeAt(0)):l=await(await fetch(a)).arrayBuffer();else if(typeof HTMLElement<"u"&&a instanceof HTMLElement)a.tagName==="IMG"&&(l=await t(a.src)),a.tagName==="VIDEO"&&(l=await t(a.poster)),a.tagName==="CANVAS"&&await new Promise(i=>{a.toBlob(async d=>{l=await o(d),i()})});else if(typeof OffscreenCanvas<"u"&&a instanceof OffscreenCanvas){const i=await a.convertToBlob();l=await o(i)}else(a instanceof File||a instanceof Blob)&&(l=await o(a));return new Uint8Array(l)};return we=t,we}var Le,Ye;function yr(){if(Ye)return Le;Ye=1;const o=fr(),t=pr(),a=hr(),l=vr(),i=gr(),d=mr();return Le={defaultOptions:o,spawnWorker:t,terminateWorker:a,onMessage:l,send:i,loadImage:d},Le}var be,xe;function Xe(){if(xe)return be;xe=1;const o=cr(),t=Ve(),{log:a}=ke(),l=Te(),i=Qe(),{defaultOptions:d,spawnWorker:h,terminateWorker:w,onMessage:I,loadImage:W,send:G}=yr();let R=0;return be=async(D="eng",z=i.LSTM_ONLY,H={},m={})=>{const L=l("Worker",R),{logger:B,errorHandler:b,...y}=o({...d,...H}),O={},k=typeof D=="string"?D.split("+"):D;let F=z,Y=m;const $=[i.DEFAULT,i.LSTM_ONLY].includes(z)&&!y.legacyCore;let N,K;const x=new Promise((u,f)=>{K=u,N=f}),oe=u=>{N(u.message)};let M=h(y);M.onerror=oe,R+=1;const A=({id:u,action:f,payload:v})=>new Promise((C,P)=>{a(`[${L}]: Start ${u}, action=${f}`);const j=`${f}-${u}`;O[j]={resolve:C,reject:P},G(M,{workerId:L,jobId:u,action:f,payload:v})}),J=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),Z=u=>A(t({id:u,action:"load",payload:{options:{lstmOnly:$,corePath:y.corePath,logging:y.logging}}})),V=(u,f,v)=>A(t({id:v,action:"FS",payload:{method:"writeFile",args:[u,f]}})),re=(u,f)=>A(t({id:f,action:"FS",payload:{method:"readFile",args:[u,{encoding:"utf8"}]}})),r=(u,f)=>A(t({id:f,action:"FS",payload:{method:"unlink",args:[u]}})),e=(u,f,v)=>A(t({id:v,action:"FS",payload:{method:u,args:f}})),n=(u,f)=>A(t({id:f,action:"loadLanguage",payload:{langs:u,options:{langPath:y.langPath,dataPath:y.dataPath,cachePath:y.cachePath,cacheMethod:y.cacheMethod,gzip:y.gzip,lstmOnly:[i.DEFAULT,i.LSTM_ONLY].includes(F)&&!y.legacyLang}}})),c=(u,f,v,C)=>A(t({id:C,action:"initialize",payload:{langs:u,oem:f,config:v}})),s=(u="eng",f,v,C)=>{if($&&[i.TESSERACT_ONLY,i.TESSERACT_LSTM_COMBINED].includes(f))throw Error("Legacy model requested but code missing.");const P=f||F;F=P;const j=v||Y;Y=j;const ne=(typeof u=="string"?u.split("+"):u).filter(er=>!k.includes(er));return k.push(...ne),ne.length>0?n(ne,C).then(()=>c(u,P,j,C)):c(u,P,j,C)},p=(u={},f)=>A(t({id:f,action:"setParameters",payload:{params:u}})),_=async(u,f={},v={text:!0},C)=>A(t({id:C,action:"recognize",payload:{image:await W(u),options:f,output:v}})),E=async(u,f)=>{if($)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return A(t({id:f,action:"detect",payload:{image:await W(u)}}))},T=async()=>(M!==null&&(w(M),M=null),Promise.resolve());I(M,({workerId:u,jobId:f,status:v,action:C,data:P})=>{const j=`${C}-${f}`;if(v==="resolve")a(`[${u}]: Complete ${f}`),O[j].resolve({jobId:f,data:P}),delete O[j];else if(v==="reject")if(O[j].reject(P),delete O[j],C==="load"&&N(P),b)b(P);else throw Error(P);else v==="progress"&&B({...P,userJobId:f})});const S={id:L,worker:M,load:J,writeText:V,readText:re,removeFile:r,FS:e,reinitialize:s,setParameters:p,recognize:_,detect:E,terminate:T};return Z().then(()=>n(D)).then(()=>c(D,z,m)).then(()=>K(S)).catch(()=>{}),x},be}var _e,He;function wr(){if(He)return _e;He=1;const o=Xe();return _e={recognize:async(l,i,d)=>{const h=await o(i,1,d);return h.recognize(l).finally(async()=>{await h.terminate()})},detect:async(l,i)=>{const d=await o("osd",0,i);return d.detect(l).finally(async()=>{await d.terminate()})}},_e}var Ee,Ke;function Lr(){return Ke||(Ke=1,Ee={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),Ee}var Se,Je;function br(){return Je||(Je=1,Se={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),Se}var Re,Ze;function _r(){if(Ze)return Re;Ze=1,nr();const o=ar(),t=Xe(),a=wr(),l=Lr(),i=Qe(),d=br(),{setLogging:h}=ke();return Re={languages:l,OEM:i,PSM:d,createScheduler:o,createWorker:t,setLogging:h,...a},Re}var Er=_r();const Sr=or(Er),Wr=()=>`
  <div class="inicio_container">
    <div class="ocr_layout">
      <!-- LEFT: Upload Zone + Preview -->
      <div class="ocr_left">
        <div class="progress_bar">
          <div class="progress_fill"></div>
          <span class="progress_text">0%</span>
        </div>
        <div class="upload_zone" id="dropZone">
          <div class="upload_placeholder">
            <i class="fas fa-cloud-upload-alt"></i>
            <h2>Arrastra tu imagen aqu√≠</h2>
            <p>o <strong>haz doble clic</strong> para seleccionar</p>
            <p class="upload_hint">Tambi√©n puedes pegar con <kbd>Ctrl+V</kbd></p>
          </div>
          <div class="image_preview dpn">
            <img src="" alt="Preview" />
            <button class="btn_clear_img" title="Eliminar imagen">
              <i class="fas fa-trash-alt"></i>
            </button>
          </div>
        </div>
      </div>

      <!-- RIGHT: Resultado -->
      <div class="ocr_right">
        <div class="progress_bar">
          <div class="progress_fill"></div>
          <span class="progress_text">0%</span>
        </div>
        <div class="result_section">
          <div class="result_header">
            <h3><i class="fas fa-file-alt"></i> Resultado de conversi√≥n</h3>
            <div class="result_actions">
              <button class="btn_icon btn_copy" title="Copiar texto">
                <i class="fas fa-copy"></i>
              </button>
              <button class="btn_icon btn_clear" title="Limpiar texto">
                <i class="fas fa-eraser"></i>
              </button>
            </div>
          </div>
          <textarea 
            id="ocrResult" 
            class="ocr_textarea" 
            placeholder="El texto extra√≠do aparecer√° aqu√≠ autom√°ticamente..."
            spellcheck="false"
          ></textarea>
        </div>
      </div>
    </div>
  </div>
`;let U=null;const g=rr,q=()=>({zona:g("#dropZone"),marcador:g(".upload_placeholder"),previsualizacion:g(".image_preview"),imagen:g(".image_preview img"),resultado:g("#ocrResult"),barraProgreso:g(".progress_bar"),relleno:g(".progress_fill"),textoProgreso:g(".progress_text"),acciones:g(".result_actions")}),X=o=>{const{barraProgreso:t,relleno:a,textoProgreso:l}=q(),i=Math.round(o*100);a.css("width",`${i}%`),l.text(`${i}%`),i>0&&i<100?t.addClass("active"):i>=100?setTimeout(()=>t.removeClass("active"),500):t.removeClass("active")},te=()=>{const{resultado:o,acciones:t}=q();t.toggleClass("active",o.val().trim().length>0)},Rr=()=>{const{previsualizacion:o,marcador:t,imagen:a}=q();o.addClass("dpn"),t.removeClass("dpn"),a.attr("src",""),X(0),U&&(U.terminate(),U=null)},Or=o=>{if(navigator.clipboard?.writeText)return navigator.clipboard.writeText(o);const t=g("<textarea>").val(o).css({position:"absolute",left:"-9999px"}).appendTo("body");return t[0].select(),document.execCommand("copy"),t.remove(),Promise.resolve()},Ae=async o=>{if(!o?.type.startsWith("image/")){ae("Selecciona una imagen v√°lida","error");return}const{imagen:t,marcador:a,previsualizacion:l,resultado:i}=q(),d=URL.createObjectURL(o);t.attr("src",d),a.addClass("dpn"),l.removeClass("dpn"),X(0);try{U=await Sr.createWorker("spa+eng",1,{logger:I=>I.status==="recognizing text"&&X(I.progress)});const{data:{text:h}}=await U.recognize(d),w=h.trim();i.val(w),Oe("ocrLastText",w,168),te(),ae("¬°Texto extra√≠do!","success"),await U.terminate(),U=null,X(1)}catch(h){console.error("Error OCR:",h),ae("Error al procesar imagen","error"),X(0)}finally{URL.revokeObjectURL(d)}},Tr=()=>{const o=g('<input type="file" accept="image/*" style="display:none;">');o.on("change",function(){this.files[0]&&Ae(this.files[0]),o.remove()}),g("body").append(o),o.click()},kr=o=>{o.preventDefault(),q().zona.addClass("dragover")},Ar=()=>{q().zona.removeClass("dragover")},Cr=o=>{o.preventDefault();const{zona:t}=q();t.removeClass("dragover");const a=o.originalEvent.dataTransfer?.files[0];a&&Ae(a)},Pr=o=>{const t=o.originalEvent.clipboardData?.items;t&&g.each(t,(a,l)=>{if(l.type.startsWith("image/")){const i=l.getAsFile();return i&&Ae(i),!1}})},Ir=function(){const{resultado:o}=q(),t=o.val().trim();if(!t){ee(this,"No hay texto","warning",1500);return}Or(t).then(()=>ee(this,"¬°Copiado!","success",1500)).catch(()=>ee(this,"Error","error",1500))},qr=function(){const{resultado:o}=q();if(!o.val().trim()){ee(this,"Ya est√° vac√≠o","info",1500);return}o.val(""),Oe("ocrLastText","",168),te(),ee(this,"¬°Limpiado!","success",1500)},Nr=o=>{o.stopPropagation(),Rr()},Mr=()=>{const{resultado:o}=q(),t=o.val().trim();t&&Oe("ocrLastText",t,168)},zr=()=>{const{zona:o,resultado:t}=q(),a=tr("ocrLastText");a&&(t.val(a),te()),o.on("dblclick",Tr).on("dragover",kr).on("dragleave",Ar).on("drop",Cr),g(document).on("paste",Pr),g(".btn_clear_img").on("click",Nr),g(".btn_copy").on("click",Ir),g(".btn_clear").on("click",qr),t.on("input",te),g(window).on("beforeunload",Mr),console.log("‚úÖ OCR Lector cargado")},Br=()=>{["paste","#dropZone",".btn_copy",".btn_clear",".btn_clear_img","#ocrResult","beforeunload"].forEach(t=>{t==="paste"?g(document).off(t):t==="beforeunload"?g(window).off(t):g(t).off()}),U?.terminate(),U=null,console.log("üßπ OCR limpiado")};export{Br as cleanup,zr as init,Wr as render};
